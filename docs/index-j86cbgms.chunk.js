var O;((e)=>{e.Bluetooth="bluetooth";e.Serial="serial";e.USB="usb";e.WebSocket="websocket";e.Imin_Build_In="imin";e.Debug="debug"})(O||={});class N{get width(){return Math.ceil(this.printableWidth*this.dpi/25.4)}get printableWidth(){switch(this.paperWidth){case 80:return 72;case 58:return 48;default:return this.paperWidth-10}}name="DEFAULT";autoConnect=!0;printerType="bluetooth";textAsImage=!0;image="rastar";sharePrinter=!1;fontSize=30;fontFace=0;lineHeight=1;paperWidth=58;dpi=203;serialOption;bluetoothOption;usbOption}function W(s,i){while(s){let t=Object.getOwnPropertyDescriptor(s,i);if(t)return!(typeof t.get==="function"&&typeof t.set==="undefined");s=Object.getPrototypeOf(s)}return!0}function x(s,i,t=!1,a=!1){if(!s||!i)return s||i;for(let n in i){if(n==="__proto__"||n==="constructor")continue;if(!W(s,n))continue;let b=s[n];switch(!0){case Array.isArray(b):{if(t)s[n]=i[n];break}case b instanceof Date:{if(t)s[n]=i[n];break}case b===void 0:case b===null:{if(a)s[n]=structuredClone(i[n]);else s[n]=i[n];break}case typeof b==="object":{x(b,i[n],t,a);break}default:if(t)s[n]=i[n]}}return s}var P;((a)=>{a[a.none=0]="none";a[a.web=1]="web";a[a.gutenye=2]="gutenye"})(P||={});class d{maxDecimal=8;maxDigit=15;deviceName="";keepScreenAwake=!0;align=2;printOperator=!1;lockSetting=!1;vibrate=!0;sound=!0;layout0="0|000|.";ocrEngine=0;autoUpdate=0;defaultConfig=new N;printerConfig={};apply(s){if(!s?.device)return;let i=s.device?.id;if(i){let t=this.printerConfig[i];if(!(t instanceof N)){if(t=x(new N,t??this.defaultConfig,!0),!t.name||t.name=="DEFAULT")t.name=s.device.name??`PRINTER ${this.defaultConfig.printerType}`.toUpperCase();this.printerConfig[i]=t}}s.option=this.printerConfig[i]??this.defaultConfig,s.setDefaultStyle({align:this.align,lineHeight:this.defaultConfig.lineHeight??1.2,font:{size:this.defaultConfig.fontSize,fontFaceType:this.defaultConfig.fontFace,fontStyle:0}})}}var z="local",Ns="server",xs="preact-calculator-cache-v1";var y=(s,i)=>i.some((t)=>s instanceof t),E,B;function A(){return E||(E=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function R(){return B||(B=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var K=new WeakMap,_=new WeakMap,h=new WeakMap;function U(s){let i=new Promise((t,a)=>{let n=()=>{s.removeEventListener("success",b),s.removeEventListener("error",e)},b=()=>{t(c(s.result)),n()},e=()=>{a(s.error),n()};s.addEventListener("success",b),s.addEventListener("error",e)});return h.set(i,s),i}function u(s){if(K.has(s))return;let i=new Promise((t,a)=>{let n=()=>{s.removeEventListener("complete",b),s.removeEventListener("error",e),s.removeEventListener("abort",e)},b=()=>{t(),n()},e=()=>{a(s.error||new DOMException("AbortError","AbortError")),n()};s.addEventListener("complete",b),s.addEventListener("error",e),s.addEventListener("abort",e)});K.set(s,i)}var V={get(s,i,t){if(s instanceof IDBTransaction){if(i==="done")return K.get(s);if(i==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return c(s[i])},set(s,i,t){return s[i]=t,!0},has(s,i){if(s instanceof IDBTransaction&&(i==="done"||i==="store"))return!0;return i in s}};function J(s){V=s(V)}function T(s){if(R().includes(s))return function(...i){return s.apply(w(this),i),c(this.request)};return function(...i){return c(s.apply(w(this),i))}}function v(s){if(typeof s==="function")return T(s);if(s instanceof IDBTransaction)u(s);if(y(s,A()))return new Proxy(s,V);return s}function c(s){if(s instanceof IDBRequest)return U(s);if(_.has(s))return _.get(s);let i=v(s);if(i!==s)_.set(s,i),h.set(i,s);return i}var w=(s)=>h.get(s);function L(s,i,{blocked:t,upgrade:a,blocking:n,terminated:b}={}){let e=indexedDB.open(s,i),S=c(e);if(a)e.addEventListener("upgradeneeded",(m)=>{a(c(e.result),m.oldVersion,m.newVersion,c(e.transaction),m)});if(t)e.addEventListener("blocked",(m)=>t(m.oldVersion,m.newVersion,m));return S.then((m)=>{if(b)m.addEventListener("close",()=>b());if(n)m.addEventListener("versionchange",(D)=>n(D.oldVersion,D.newVersion,D))}).catch(()=>{}),S}var F=["get","getKey","getAll","getAllKeys","count"],q=["put","add","delete","clear"],l=new Map;function j(s,i){if(!(s instanceof IDBDatabase&&!(i in s)&&typeof i==="string"))return;if(l.get(i))return l.get(i);let t=i.replace(/FromIndex$/,""),a=i!==t,n=q.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(n||F.includes(t)))return;let b=async function(e,...S){let m=this.transaction(e,n?"readwrite":"readonly"),D=m.store;if(a)D=D.index(S.shift());return(await Promise.all([D[t](...S),n&&m.done]))[0]};return l.set(i,b),b}J((s)=>({...s,get:(i,t,a)=>j(i,t)||s.get(i,t,a),has:(i,t)=>!!j(i,t)||s.has(i,t)}));var M=["continue","continuePrimaryKey","advance"],o={},C=new WeakMap,Q=new WeakMap,g={get(s,i){if(!M.includes(i))return s[i];let t=o[i];if(!t)t=o[i]=function(...a){C.set(this,Q.get(this)[i](...a))};return t}};async function*r(...s){let i=this;if(!(i instanceof IDBCursor))i=await i.openCursor(...s);if(!i)return;i=i;let t=new Proxy(i,g);Q.set(t,i),h.set(t,w(i));while(i)yield t,i=await(C.get(t)||i.continue()),C.delete(t)}function H(s,i){return i===Symbol.asyncIterator&&y(s,[IDBIndex,IDBObjectStore,IDBCursor])||i==="iterate"&&y(s,[IDBIndex,IDBObjectStore])}J((s)=>({...s,get(i,t,a){if(H(i,t))return r;return s.get(i,t,a)},has(i,t){return H(i,t)||s.has(i,t)}}));var f=!1;class X{async persist(){if(f||!("persist"in navigator.storage))return;if(f=await navigator.storage.persisted(),f)return;return f=await navigator.storage.persist(),f}}var ss=new X,Y=ss;class Z{constructor(s,i){this._store=s,this._deserialize=i}_store;_deserialize;async add(s){return await this._store.add?.(s)}async set(s){return await this._store.put?.(s)}async has(s){return await this._store.getKey(s)!==void 0}async get(s){let i=await this._store.get(s);if(this._deserialize)i=this._deserialize(i);return i}async getAll(s){return(await this._store.getAll(null,s))?.map((t)=>{if(this._deserialize)t=this._deserialize(t);return t})??[]}async delete(s){return await this._store.delete?.(s)}}class I{_db;_option;constructor(s){this._option=s}async open(){if(!this._db)await Y.persist(),this._db=await L(this._option.name,this._option.version,this._option);return this._db}async has(s,i){let t=!1;return await this.transaction([s],"readonly",async(a)=>{t=await a[s].has(i)}),t}async set(s,i){await this.transaction([s],async(t)=>{await t[s].set(i)})}async get(s,i){let t;return await this.transaction([s],"readonly",async(a)=>{t=await a[s].get(i)}),t}async getAll(s,i){let t;return await this.transaction([s],"readonly",async(a)=>{t=await a[s].getAll(i)}),t??[]}async delete(s,i){await this.transaction([s],async(t)=>{await t[s].delete(i)})}async transaction(s,i,t){let a="readwrite";if(!t)t=i;else a=i;let b=(await this.open()).transaction(s,a),e={};for(let S of s){let m=void 0;Object.defineProperty(e,S,{get:()=>{if(!m)m=new Z(b.objectStore(S),this._option.deserialize?.[S]);return m}})}await t(e),b.commit(),await b.done}}class k{_ixDbService;constructor(s="kv",i){this._ixDbService=new I({name:s,version:1,upgrade:(t,a,n,b,e)=>{if(t.createObjectStore("kv",{keyPath:"key"}),i)i(t,b),i=void 0}})}async set(s,i){await this._ixDbService.set("kv",{key:s,value:i})}async has(s){return await this._ixDbService.has("kv",s)}async get(s,i){let a=(await this._ixDbService.get("kv",s))?.value;if(i)a=x(new i,a,!0);return a}async delete(s){await this._ixDbService.delete("kv",s)}}class ${version;app_files;assets}class G extends k{constructor(s){super(s)}async get(s,i){switch(s){case"setting":{i=d;break}case"version":{i=$;break}case"lastCheck":{i=void 0;break}}return super.get(s,i)}async set(s,i){return super.set(s,i)}}var Is=new G(z);
export{x as $,O as aa,N as ba,P as ca,d as da,Ns as ea,xs as fa,Y as ga,I as ha,Is as ia};
