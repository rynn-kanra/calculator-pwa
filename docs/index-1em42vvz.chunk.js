var Y;((n)=>{n.Bluetooth="bluetooth";n.Serial="serial";n.USB="usb";n.WebSocket="websocket";n.Imin_Build_In="imin";n.Debug="debug"})(Y||={});class S{get width(){return Math.ceil(this.printableWidth*this.dpi/25.4)}get charPerLine(){return this.printableWidth/1.5}get printableWidth(){switch(this.paperWidth){case 80:return 72;case 58:return 48;default:return this.paperWidth-10}}name="DEFAULT";autoConnect=!0;printerType="bluetooth";textAsImage=!0;image="rastar";sharePrinter=!1;fontSize=30;fontFace=0;lineHeight=1;paperWidth=58;dpi=203;serialOption;bluetoothOption;usbOption}function Z(i,t){while(i){let a=Object.getOwnPropertyDescriptor(i,t);if(a)return!(typeof a.get==="function"&&typeof a.set==="undefined");i=Object.getPrototypeOf(i)}return!0}function x(i,t,a=!1,s=!1){if(!i||!t)return i||t;for(let e in t){if(e==="__proto__"||e==="constructor")continue;if(!Z(i,e))continue;let c=i[e];switch(!0){case Array.isArray(c):{if(a)i[e]=t[e];break}case c instanceof Date:{if(a)i[e]=t[e];break}case c===void 0:case c===null:{if(s)i[e]=structuredClone(t[e]);else i[e]=t[e];break}case typeof c==="object":{x(c,t[e],a,s);break}default:if(a)i[e]=t[e]}}return i}var $;((s)=>{s[s.none=0]="none";s[s.web=1]="web";s[s.gutenye=2]="gutenye"})($||={});class N{maxDecimal=8;maxDigit=15;deviceName="";keepScreenAwake=!0;align=2;printOperator=!1;lockSetting=!1;vibrate=!0;sound=!0;layout0="0|000|.";ocrEngine=0;autoUpdate=0;defaultConfig=new S;printerConfig={};apply(i){if(!i?.device)return;let t=i.device?.id;if(t){let a=this.printerConfig[t];if(!(a instanceof S)){if(a=x(new S,a??this.defaultConfig,!0),!a.name||a.name=="DEFAULT")a.name=i.device.name??`PRINTER ${this.defaultConfig.printerType}`.toUpperCase();this.printerConfig[t]=a}}i.option=this.printerConfig[t]??this.defaultConfig,i.setDefaultStyle({align:this.align,lineHeight:this.defaultConfig.lineHeight??1.2,font:{size:this.defaultConfig.fontSize,fontFaceType:this.defaultConfig.fontFace,fontStyle:0}})}}var w="local",oi="server",Si="preact-calculator-cache-v1";var h=(i,t)=>t.some((a)=>i instanceof a),I,k;function A(){return I||(I=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function W(){return k||(k=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var B=new WeakMap,f=new WeakMap,y=new WeakMap;function R(i){let t=new Promise((a,s)=>{let e=()=>{i.removeEventListener("success",c),i.removeEventListener("error",n)},c=()=>{a(o(i.result)),e()},n=()=>{s(i.error),e()};i.addEventListener("success",c),i.addEventListener("error",n)});return y.set(t,i),t}function U(i){if(B.has(i))return;let t=new Promise((a,s)=>{let e=()=>{i.removeEventListener("complete",c),i.removeEventListener("error",n),i.removeEventListener("abort",n)},c=()=>{a(),e()},n=()=>{s(i.error||new DOMException("AbortError","AbortError")),e()};i.addEventListener("complete",c),i.addEventListener("error",n),i.addEventListener("abort",n)});B.set(i,t)}var _={get(i,t,a){if(i instanceof IDBTransaction){if(t==="done")return B.get(i);if(t==="store")return a.objectStoreNames[1]?void 0:a.objectStore(a.objectStoreNames[0])}return o(i[t])},set(i,t,a){return i[t]=a,!0},has(i,t){if(i instanceof IDBTransaction&&(t==="done"||t==="store"))return!0;return t in i}};function P(i){_=i(_)}function F(i){if(W().includes(i))return function(...t){return i.apply(K(this),t),o(this.request)};return function(...t){return o(i.apply(K(this),t))}}function M(i){if(typeof i==="function")return F(i);if(i instanceof IDBTransaction)U(i);if(h(i,A()))return new Proxy(i,_);return i}function o(i){if(i instanceof IDBRequest)return R(i);if(f.has(i))return f.get(i);let t=M(i);if(t!==i)f.set(i,t),y.set(t,i);return t}var K=(i)=>y.get(i);function H(i,t,{blocked:a,upgrade:s,blocking:e,terminated:c}={}){let n=indexedDB.open(i,t),b=o(n);if(s)n.addEventListener("upgradeneeded",(d)=>{s(o(n.result),d.oldVersion,d.newVersion,o(n.transaction),d)});if(a)n.addEventListener("blocked",(d)=>a(d.oldVersion,d.newVersion,d));return b.then((d)=>{if(c)d.addEventListener("close",()=>c());if(e)d.addEventListener("versionchange",(m)=>e(m.oldVersion,m.newVersion,m))}).catch(()=>{}),b}var u=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],l=new Map;function z(i,t){if(!(i instanceof IDBDatabase&&!(t in i)&&typeof t==="string"))return;if(l.get(t))return l.get(t);let a=t.replace(/FromIndex$/,""),s=t!==a,e=v.includes(a);if(!(a in(s?IDBIndex:IDBObjectStore).prototype)||!(e||u.includes(a)))return;let c=async function(n,...b){let d=this.transaction(n,e?"readwrite":"readonly"),m=d.store;if(s)m=m.index(b.shift());return(await Promise.all([m[a](...b),e&&d.done]))[0]};return l.set(t,c),c}P((i)=>({...i,get:(t,a,s)=>z(t,a)||i.get(t,a,s),has:(t,a)=>!!z(t,a)||i.has(t,a)}));var q=["continue","continuePrimaryKey","advance"],E={},C=new WeakMap,O=new WeakMap,g={get(i,t){if(!q.includes(t))return i[t];let a=E[t];if(!a)a=E[t]=function(...s){C.set(this,O.get(this)[t](...s))};return a}};async function*r(...i){let t=this;if(!(t instanceof IDBCursor))t=await t.openCursor(...i);if(!t)return;t=t;let a=new Proxy(t,g);O.set(a,t),y.set(a,K(t));while(t)yield a,t=await(C.get(a)||t.continue()),C.delete(a)}function j(i,t){return t===Symbol.asyncIterator&&h(i,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&h(i,[IDBIndex,IDBObjectStore])}P((i)=>({...i,get(t,a,s){if(j(t,a))return r;return i.get(t,a,s)},has(t,a){return j(t,a)||i.has(t,a)}}));var D=!1;class G{async persist(){if(D||!("persist"in navigator.storage))return;if(D=await navigator.storage.persisted(),D)return;return D=await navigator.storage.persist(),D}}var ii=new G,J=ii;class L{constructor(i,t){this._store=i,this._deserialize=t}_store;_deserialize;async add(i){return await this._store.add?.(i)}async set(i){return await this._store.put?.(i)}async has(i){return await this._store.getKey(i)!==void 0}async get(i){let t=await this._store.get(i);if(this._deserialize)t=this._deserialize(t);return t}async getAll(i){return(await this._store.getAll(null,i))?.map((a)=>{if(this._deserialize)a=this._deserialize(a);return a})??[]}async delete(i){return await this._store.delete?.(i)}}class T{_db;_option;constructor(i){this._option=i}async open(){if(!this._db)await J.persist(),this._db=await H(this._option.name,this._option.version,this._option);return this._db}async has(i,t){let a=!1;return await this.transaction([i],"readonly",async(s)=>{a=await s[i].has(t)}),a}async set(i,t){await this.transaction([i],async(a)=>{await a[i].set(t)})}async get(i,t){let a;return await this.transaction([i],"readonly",async(s)=>{a=await s[i].get(t)}),a}async getAll(i,t){let a;return await this.transaction([i],"readonly",async(s)=>{a=await s[i].getAll(t)}),a??[]}async delete(i,t){await this.transaction([i],async(a)=>{await a[i].delete(t)})}async transaction(i,t,a){let s="readwrite";if(!a)a=t;else s=t;let c=(await this.open()).transaction(i,s),n={};for(let b of i){let d=void 0;Object.defineProperty(n,b,{get:()=>{if(!d)d=new L(c.objectStore(b),this._option.deserialize?.[b]);return d}})}await a(n),c.commit(),await c.done}}class V{_ixDbService;constructor(i="kv",t){this._ixDbService=new T({name:i,version:1,upgrade:(a,s,e,c,n)=>{if(a.createObjectStore("kv",{keyPath:"key"}),t)t(a,c),t=void 0}})}async set(i,t){await this._ixDbService.set("kv",{key:i,value:t})}async has(i){return await this._ixDbService.has("kv",i)}async get(i,t){let s=(await this._ixDbService.get("kv",i))?.value;if(t)s=x(new t,s,!0);return s}async delete(i){await this._ixDbService.delete("kv",i)}}class Q{version;app_files;assets}class X extends V{constructor(i){super(i)}async get(i,t){switch(i){case"setting":{t=N;break}case"version":{t=Q;break}case"lastCheck":{t=void 0;break}}return super.get(i,t)}async set(i,t){return super.set(i,t)}}var Ci=new X(w);
export{x as fa,Y as ga,S as ha,$ as ia,N as ja,oi as ka,Si as la,J as ma,T as na,Ci as oa};
