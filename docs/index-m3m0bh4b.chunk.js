var J={printer:void 0},M=J;class B{target;event;options;stopped;handler;subscribers=new Set;iterators=new Set;constructor(f,j,w){this.target=f;this.event=j;this.options=w}async*[Symbol.asyncIterator](){if(this.stopped)return;if(this.init(),!this.iterators)this.iterators=new Set;let f={queue:[],resolve:void 0};this.iterators.add(f);try{do{while(f.queue.length>0)yield f.queue.shift();if(this.stopped)break;await new Promise((j)=>{f.resolve=j}),f.resolve=void 0}while(!0)}finally{if(this.iterators?.delete(f),!this.iterators?.size&&!this.subscribers?.size)this.unsubscribe()}}init(){if(this.handler)return;if(this.handler=(f)=>{if(this.stopped)return;if(this.iterators)for(let j of this.iterators)j.queue.push(f),j.resolve?.();if(this.subscribers)for(let j of this.subscribers)try{j.call(this.target,f)}catch(w){}},this.options?.signal)this.options?.signal?.addEventListener("abort",()=>{this.stop()},{once:!0});this.target.addEventListener(this.event,this.handler,this.options)}subscribe(f,j){if(this.stopped)return;if(this.init(),!this.subscribers)this.subscribers=new Set;if(this.subscribers.add(f),j)j.addEventListener("abort",()=>{this.unsubscribe(f)},{once:!0})}unsubscribe(f){if(this.stopped||!this.handler)return;if(f)this.subscribers?.delete(f);else this.subscribers=void 0;if(!this.iterators?.size&&!this.subscribers?.size)this.stop()}stop(){if(this.stopped||!this.handler)return;if(this.stopped=!0,this.target.removeEventListener(this.event,this.handler,this.options),this.iterators)for(let f of this.iterators)f.resolve?.();this.subscribers=void 0,this.iterators=void 0,this.handler=void 0,this.options=void 0}}function C(f,j,w){return new B(f,j,w)}class F{_wakeLock;_idleListener;async wakeLock(){if(this.isWakeLocked)return!0;try{return this._wakeLock=await navigator.wakeLock.request("screen"),document.addEventListener("visibilitychange",async()=>{if(this._wakeLock!==null&&document.visibilityState==="visible")this._wakeLock=await navigator.wakeLock.request("screen")}),!0}catch(f){return!1}}get isWakeLocked(){return this._wakeLock?.released==!1}async releaseWakeLock(){if(!this._wakeLock)return;await this._wakeLock.release(),this._wakeLock=void 0}orientiation(){return screen?.orientation?.type}async orientiationLock(f){try{return await screen.orientation.lock(f),!0}catch(j){return!1}}orientiationUnlock(){try{screen.orientation.unlock()}catch(f){}}async fullscreen(f){if(!document?.fullscreenEnabled)return!1;try{if(!f)f=document.body;return await f.requestFullscreen(),!0}catch(j){return!1}}async fullscreenExit(){if(!document?.fullscreenEnabled||!document?.fullscreenElement)return!0;try{return await document.exitFullscreen(),!0}catch(f){return!1}}async idleEvent(f=60000){if(!this._idleListener)this._idleListener={};let j=this._idleListener[f];if(!j){if((await navigator.permissions.query({name:"idle-detection"})).state!=="granted")throw new Error("permission denied");let z=new IdleDetector,A=new AbortController;await z.start({threshold:f,signal:A.signal}),j=C(z,"change"),this._idleListener[f]=j;let G=j.stop;j.stop=()=>{A.abort(),G.call(j),this._idleListener[f]=void 0}}return j}}var K=new F,Y=K;
export{M as d,Y as e};
