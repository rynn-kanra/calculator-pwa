import{V as B,W as k,X as P,Y as jsxDEV,_ as V}from"./index-pehnjj2g.chunk.js";import"./index-j86cbgms.chunk.js";import"./index-wj4h4tw5.chunk.js";var S=()=>{let H=P(null),U=P(null),W=P(null),Z=P(null),[y,j]=B(),[Q,_]=B(!1),[,,F]=V(),G={x:0.1,y:0.1,width:0.8,height:0.8},L=0;if(window.innerWidth<window.innerHeight)L=window.innerWidth*G.width,G.height=Math.round(L*100/window.innerHeight)/100,G.y=(1-G.height)/2;else if(window.innerWidth>window.innerHeight)L=window.innerHeight*G.height,G.width=Math.round(L*100/window.innerWidth)/100,G.x=(1-G.width)/2;else L=window.innerWidth*G.width;G.y=G.y*0.5,k(()=>{if(!("BarcodeDetector"in window)){alert("BarcodeDetector is not supported.");return}let $,E=new BarcodeDetector,w=async()=>{let K=!0;try{if(!H.current)return;if(!U.current)return;let J=H.current,T=U.current,O=J.getBoundingClientRect(),z=J.videoWidth/J.videoHeight,q=O.width/O.height,M,N,C=0,p=0;if(q>z)M=J.videoWidth,N=J.videoWidth/q,p=(J.videoHeight-N)/2;else N=J.videoHeight,M=J.videoHeight*q,C=(J.videoWidth-M)/2;let g=M*G.x+C,u=N*G.y+p,X=M*G.width,Y=N*G.height;T.width=X,T.height=Y,T.getContext("2d").drawImage(J,g,u,X,Y,0,0,X,Y);let A=await E.detect(T);if(A.length>0){if(A[0].rawValue){F(),j(A[0]),W.current?.showModal(),H.current?.pause(),_(!1),K=!1;return}}}catch(J){}finally{if(K)Z.current?.()}};Z.current=()=>{if(H.current?.paused)H.current.play();_(!0),setTimeout(function(){cancelAnimationFrame($),$=requestAnimationFrame(()=>w())},300)};let D=()=>{if(cancelAnimationFrame($),H.current?.srcObject instanceof MediaStream)H.current.srcObject.getTracks().forEach((K)=>K.stop()),H.current.srcObject=null};return navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",zoom:{ideal:1},focusMode:"continuous"}}).then((K)=>{if(H.current)H.current.srcObject=K,_(!0),w()}).catch((K)=>{}),()=>{D()}},[]),k(()=>{if(H.current)H.current.addEventListener("pause",function(){this.style.filter="blur(5px)"}),H.current.addEventListener("play",function(){this.style.filter=""})},[H]);let l=()=>{F(),Z.current?.(),W.current?.close()},I=Math.round(L/10);return jsxDEV("div",{style:{height:"100dvh",width:"100dvw",position:"relative",viewTransitionName:"view-scale"},children:[jsxDEV("canvas",{ref:U,style:{display:"none"}},void 0,!1,void 0,this),jsxDEV("video",{ref:H,autoPlay:!0,playsInline:!0,style:{width:"100%",backgroundColor:"black",height:"100%",objectFit:"cover",transition:"filter 0.3s ease"}},void 0,!1,void 0,this),jsxDEV("div",{style:{position:"absolute",background:"rgba(0, 0, 0, 0.4)",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",clipPath:`polygon(
            0% 0%, 100% 0%, 100% 100%, 0% 100%,
            0% 0%,
            ${G.x*100}% ${G.y*100}%, ${G.x*100}% ${(G.y+G.height)*100}%, ${(G.x+G.width)*100}% ${(G.y+G.height)*100}%, ${(G.x+G.width)*100}% ${G.y*100}%, ${G.x*100}% ${G.y*100}%
          )`}},void 0,!1,void 0,this),jsxDEV("div",{style:{position:"absolute",width:`${I}px`,height:`${I}px`,borderWidth:"3px",borderColor:Q?"#f44336":"#666",top:`calc(${G.y*100}% - 2px)`,left:`calc(${G.x*100}% - 2px)`,borderStyle:"solid none none solid",transition:"border-color 0.3s ease"}},void 0,!1,void 0,this),jsxDEV("div",{style:{position:"absolute",width:`${I}px`,height:`${I}px`,borderWidth:"3px",borderColor:Q?"#f44336":"#666",top:`calc(${G.y*100}% - 2px)`,left:`calc(${(G.x+G.width)*100}% - ${I-3+1}px)`,borderStyle:"solid solid none none",transition:"border-color 0.3s ease"}},void 0,!1,void 0,this),jsxDEV("div",{style:{position:"absolute",width:`${I}px`,height:`${I}px`,borderWidth:"3px",borderColor:Q?"#f44336":"#666",top:`calc(${(G.y+G.height)*100}% - ${I-3+1}px)`,left:`calc(${(G.x+G.width)*100}% - ${I-3+1}px)`,borderStyle:"none solid solid none",transition:"border-color 0.3s ease"}},void 0,!1,void 0,this),jsxDEV("div",{style:{position:"absolute",width:`${I}px`,height:`${I}px`,borderWidth:"3px",borderColor:Q?"#f44336":"#666",top:`calc(${(G.y+G.height)*100}% - ${I-3+1}px)`,left:`calc(${G.x*100}% - 2px)`,borderStyle:"none none solid solid",transition:"border-color 0.3s ease"}},void 0,!1,void 0,this),jsxDEV("dialog",{ref:W,style:{margin:"0 auto",top:`${(G.y+G.height/4)*100}%`,maxWidth:`${(G.width-0.1)*100}%`},children:[jsxDEV("div",{children:[jsxDEV("p",{style:{margin:0,textTransform:"uppercase"},children:["FORMAT: ",y?.format]},void 0,!0,void 0,this),jsxDEV("p",{style:{margin:0,overflowWrap:"break-word"},children:y?.rawValue},void 0,!1,void 0,this)]},void 0,!0,void 0,this),jsxDEV("div",{style:{textAlign:"right",marginTop:"1rem"},children:jsxDEV("button",{class:"btn-small",style:{color:"white",backgroundColor:"#4caf50",borderColor:"#4caf50",margin:0},onClick:l,children:"CONTINUE"},void 0,!1,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)},f=S;export{f as default};
