var Z;((n)=>{n.Bluetooth="bluetooth";n.Serial="serial";n.USB="usb";n.WebSocket="websocket";n.Imin_Build_In="imin";n.Debug="debug"})(Z||={});class x{get width(){return Math.ceil(this.printableWidth*this.dpi/25.4)}get charPerLine(){return this.printableWidth/1.5}get printableWidth(){switch(this.paperWidth){case 80:return 72;case 58:return 48;default:return this.paperWidth-10}}name="DEFAULT";autoConnect=!0;printerType="bluetooth";textAsImage=!0;barcodeAsImage=!1;image="rastar";sharePrinter=!1;fontSize=30;fontFace=0;lineHeight=1;paperWidth=58;dpi=203;serialOption;bluetoothOption;usbOption}function $(t,i){while(t){let s=Object.getOwnPropertyDescriptor(t,i);if(s)return!(typeof s.get==="function"&&typeof s.set>"u");t=Object.getPrototypeOf(t)}return!0}function D(t,i,s=!1,a=!1){if(!t||!i)return t||i;for(let e in i){if(e==="__proto__"||e==="constructor")continue;if(!$(t,e))continue;let b=t[e];switch(!0){case Array.isArray(b):{if(s)t[e]=i[e];break}case b instanceof Date:{if(s)t[e]=i[e];break}case b===void 0:case b===null:{if(a)t[e]=structuredClone(i[e]);else t[e]=i[e];break}case typeof b==="object":{D(b,i[e],s,a);break}default:if(s)t[e]=i[e]}}return t}var A;((a)=>{a[a.none=0]="none";a[a.web=1]="web";a[a.gutenye=2]="gutenye"})(A||={});var E;((e)=>{e[e.camera=0]="camera";e[e.keyboard_mode=1]="keyboard_mode";e[e.webhid=2]="webhid";e[e.webserial=3]="webserial"})(E||={});class N{maxDecimal=8;maxDigit=15;deviceName="";keepScreenAwake=!0;align=2;printOperator=!1;lockSetting=!1;vibrate=!0;sound=!0;layout0="0|000|.";ocrEngine=0;barcodeScannerEngine=0;autoUpdate=0;defaultConfig=new x;printerConfig={};apply(t){if(!t?.device)return;let i=t.device?.id;if(i){let s=this.printerConfig[i];if(!(s instanceof x)){if(s=D(new x,s??this.defaultConfig,!0),!s.name||s.name=="DEFAULT")s.name=t.device.name??`PRINTER ${this.defaultConfig.printerType}`.toUpperCase();this.printerConfig[i]=s}}t.option=this.printerConfig[i]??this.defaultConfig,t.setDefaultStyle({align:this.align,lineHeight:this.defaultConfig.lineHeight??1.2,font:{size:this.defaultConfig.fontSize,fontFaceType:this.defaultConfig.fontFace,fontStyle:0}})}}var w="local",xt="server",Dt="preact-calculator-cache-v1";var h=(t,i)=>i.some((s)=>t instanceof s),I,k;function W(){return I||(I=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function R(){return k||(k=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var _=new WeakMap,f=new WeakMap,S=new WeakMap;function U(t){let i=new Promise((s,a)=>{let e=()=>{t.removeEventListener("success",b),t.removeEventListener("error",n)},b=()=>{s(o(t.result)),e()},n=()=>{a(t.error),e()};t.addEventListener("success",b),t.addEventListener("error",n)});return S.set(i,t),i}function F(t){if(_.has(t))return;let i=new Promise((s,a)=>{let e=()=>{t.removeEventListener("complete",b),t.removeEventListener("error",n),t.removeEventListener("abort",n)},b=()=>{s(),e()},n=()=>{a(t.error||new DOMException("AbortError","AbortError")),e()};t.addEventListener("complete",b),t.addEventListener("error",n),t.addEventListener("abort",n)});_.set(t,i)}var B={get(t,i,s){if(t instanceof IDBTransaction){if(i==="done")return _.get(t);if(i==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return o(t[i])},set(t,i,s){return t[i]=s,!0},has(t,i){if(t instanceof IDBTransaction&&(i==="done"||i==="store"))return!0;return i in t}};function H(t){B=t(B)}function M(t){if(R().includes(t))return function(...i){return t.apply(K(this),i),o(this.request)};return function(...i){return o(t.apply(K(this),i))}}function u(t){if(typeof t==="function")return M(t);if(t instanceof IDBTransaction)F(t);if(h(t,W()))return new Proxy(t,B);return t}function o(t){if(t instanceof IDBRequest)return U(t);if(f.has(t))return f.get(t);let i=u(t);if(i!==t)f.set(t,i),S.set(i,t);return i}var K=(t)=>S.get(t);function O(t,i,{blocked:s,upgrade:a,blocking:e,terminated:b}={}){let n=indexedDB.open(t,i),d=o(n);if(a)n.addEventListener("upgradeneeded",(m)=>{a(o(n.result),m.oldVersion,m.newVersion,o(n.transaction),m)});if(s)n.addEventListener("blocked",(m)=>s(m.oldVersion,m.newVersion,m));return d.then((m)=>{if(b)m.addEventListener("close",()=>b());if(e)m.addEventListener("versionchange",(c)=>e(c.oldVersion,c.newVersion,c))}).catch(()=>{}),d}var v=["get","getKey","getAll","getAllKeys","count"],q=["put","add","delete","clear"],l=new Map;function z(t,i){if(!(t instanceof IDBDatabase&&!(i in t)&&typeof i==="string"))return;if(l.get(i))return l.get(i);let s=i.replace(/FromIndex$/,""),a=i!==s,e=q.includes(s);if(!(s in(a?IDBIndex:IDBObjectStore).prototype)||!(e||v.includes(s)))return;let b=async function(n,...d){let m=this.transaction(n,e?"readwrite":"readonly"),c=m.store;if(a)c=c.index(d.shift());return(await Promise.all([c[s](...d),e&&m.done]))[0]};return l.set(i,b),b}H((t)=>({...t,get:(i,s,a)=>z(i,s)||t.get(i,s,a),has:(i,s)=>!!z(i,s)||t.has(i,s)}));var g=["continue","continuePrimaryKey","advance"],j={},C=new WeakMap,G=new WeakMap,r={get(t,i){if(!g.includes(i))return t[i];let s=j[i];if(!s)s=j[i]=function(...a){C.set(this,G.get(this)[i](...a))};return s}};async function*p(...t){let i=this;if(!(i instanceof IDBCursor))i=await i.openCursor(...t);if(!i)return;i=i;let s=new Proxy(i,r);G.set(s,i),S.set(s,K(i));while(i)yield s,i=await(C.get(s)||i.continue()),C.delete(s)}function P(t,i){return i===Symbol.asyncIterator&&h(t,[IDBIndex,IDBObjectStore,IDBCursor])||i==="iterate"&&h(t,[IDBIndex,IDBObjectStore])}H((t)=>({...t,get(i,s,a){if(P(i,s))return p;return t.get(i,s,a)},has(i,s){return P(i,s)||t.has(i,s)}}));var y=!1;class J{async persist(){if(y||!("persist"in navigator.storage))return;if(y=await navigator.storage.persisted(),y)return;return y=await navigator.storage.persist(),y}}var it=new J,L=it;class Q{constructor(t,i){this._store=t,this._deserialize=i}_store;_deserialize;async add(t){return await this._store.add?.(t)}async set(t){return await this._store.put?.(t)}async has(t){return await this._store.getKey(t)!==void 0}async get(t){let i=await this._store.get(t);if(this._deserialize)i=this._deserialize(i);return i}async getAll(t){return(await this._store.getAll(null,t))?.map((s)=>{if(this._deserialize)s=this._deserialize(s);return s})??[]}async delete(t){return await this._store.delete?.(t)}}class T{_db;_option;constructor(t){this._option=t}async open(){if(!this._db)await L.persist(),this._db=await O(this._option.name,this._option.version,this._option);return this._db}async has(t,i){let s=!1;return await this.transaction([t],"readonly",async(a)=>{s=await a[t].has(i)}),s}async set(t,i){await this.transaction([t],async(s)=>{await s[t].set(i)})}async get(t,i){let s;return await this.transaction([t],"readonly",async(a)=>{s=await a[t].get(i)}),s}async getAll(t,i){let s;return await this.transaction([t],"readonly",async(a)=>{s=await a[t].getAll(i)}),s??[]}async delete(t,i){await this.transaction([t],async(s)=>{await s[t].delete(i)})}async transaction(t,i,s){let a="readwrite";if(!s)s=i;else a=i;let b=(await this.open()).transaction(t,a),n={};for(let d of t){let m=void 0;Object.defineProperty(n,d,{get:()=>{if(!m)m=new Q(b.objectStore(d),this._option.deserialize?.[d]);return m}})}await s(n),b.commit(),await b.done}}class V{_ixDbService;constructor(t="kv",i){this._ixDbService=new T({name:t,version:1,upgrade:(s,a,e,b,n)=>{if(s.createObjectStore("kv",{keyPath:"key"}),i)i(s,b),i=void 0}})}async set(t,i){await this._ixDbService.set("kv",{key:t,value:i})}async has(t){return await this._ixDbService.has("kv",t)}async get(t,i){let a=(await this._ixDbService.get("kv",t))?.value;if(i)a=D(new i,a,!0);return a}async delete(t){await this._ixDbService.delete("kv",t)}}class X{version;app_files;assets}class Y extends V{constructor(t){super(t)}async get(t,i){switch(t){case"setting":{i=N;break}case"version":{i=X;break}case"lastCheck":{i=void 0;break}}return super.get(t,i)}async set(t,i){return super.set(t,i)}}var Tt=new Y(w);
export{D as ea,Z as fa,x as ga,A as ha,E as ia,N as ja,xt as ka,Dt as la,L as ma,T as na,Tt as oa};
